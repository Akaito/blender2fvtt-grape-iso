{
  "_id": "tZ6P3VnDG01IXp9U",
  "name": "blender2grape-iso",
  "type": "script",
  "sort": 100001,
  "flags": {
    "exportSource": {
      "world": "5e-srd",
      "system": "dnd5e",
      "coreVersion": "0.7.8",
      "systemVersion": "1.1.1"
    }
  },
  "scope": "global",
  "command": "let gridSize = canvas.scene.data.grid;\nlet foundrySceneOrigin = [\n  Math.floor((canvas.scene.data.width\n    + canvas.scene.data.padding*2*canvas.scene.data.width) / 2),\n  Math.floor((canvas.scene.data.height +\n    canvas.scene.data.padding*2*canvas.scene.data.height) / 2),\n];\nlet jsn = get_blender_jsn();\njsn['walls']?.forEach(wall => importBlenderWall(wall));\ncanvas.walls.activate();  // switch to walls layer\n\n\n// Flip x and y from the Blender export.\n// This is kind of a hack.\n// Blender's camera is assumed to be looking down neg-x, pos-y.\n// Foundry in Grape's isometric is looking down pos-x, neg-y.\nfunction importBlenderWall(wallJson) {\n  let sense = CONST.WALL_SENSE_TYPES.NORMAL;\n  if (wallJson['isFrontFacing'] !== true)\n    sense = CONST.WALL_SENSE_TYPES.NONE;\n  canvas.scene.createEmbeddedEntity(\"Wall\", {\n    c: [\n      foundrySceneOrigin[0] + wallJson.a[1] * gridSize,\n      foundrySceneOrigin[1] + wallJson.a[0] * gridSize,\n      foundrySceneOrigin[0] + wallJson.b[1] * gridSize,\n      foundrySceneOrigin[1] + wallJson.b[0] * gridSize\n    ],\n    sense: sense,\n  });\n}\n\n\nfunction get_blender_jsn() {\n  return {\n  \"walls\": [\n    {\n      \"a\": [\n        6.0,\n        1.0,\n        0.0\n      ],\n      \"b\": [\n        6.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.003\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        10.0,\n        1.0,\n        0.0\n      ],\n      \"b\": [\n        6.0,\n        1.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.003\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        10.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        10.0,\n        1.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.003\",\n      \"isFrontFacing\": true\n    },\n    {\n      \"a\": [\n        6.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        10.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.003\",\n      \"isFrontFacing\": true\n    },\n    {\n      \"a\": [\n        0.0,\n        1.0,\n        0.0\n      ],\n      \"b\": [\n        0.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.001\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        4.0,\n        1.0,\n        0.0\n      ],\n      \"b\": [\n        0.0,\n        1.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.001\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        4.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        4.0,\n        1.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.001\",\n      \"isFrontFacing\": true\n    },\n    {\n      \"a\": [\n        0.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        4.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.001\",\n      \"isFrontFacing\": true\n    },\n    {\n      \"a\": [\n        -1.0,\n        -4.0,\n        0.0\n      ],\n      \"b\": [\n        0.0,\n        -4.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.002\",\n      \"isFrontFacing\": true\n    },\n    {\n      \"a\": [\n        -1.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        -1.0,\n        -4.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.002\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        0.0,\n        0.0,\n        0.0\n      ],\n      \"b\": [\n        -1.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.002\",\n      \"isFrontFacing\": false\n    },\n    {\n      \"a\": [\n        0.0,\n        -4.0,\n        0.0\n      ],\n      \"b\": [\n        0.0,\n        0.0,\n        0.0\n      ],\n      \"blenderObjectName\": \"wall.002\",\n      \"isFrontFacing\": true\n    }\n  ]\n}\n}",
  "author": "2pwDDMtPZQq5dX12",
  "img": "icons/svg/castle.svg",
  "actorIds": []
}